version: 2

models:

  - name: dim_event
    description: "Dimension table for event signatures with categorization"
    columns:
      - name: topic0_hash
        description: "Event signature hash (keccak256, hex string with 0x prefix)"
        tests:
          - not_null
          - unique
      - name: event_name
        description: "Human-readable event name (e.g., Transfer, Approval)"
      - name: event_signature
        description: "Full event signature (e.g., Transfer(address,address,uint256))"
      - name: event_base_name
        description: "Base event name parsed from signature"
      - name: event_parameters
        description: "Parameter types parsed from signature"
      - name: event_category
        description: "Event category: token_transfer, token_approval, access_control, contract_upgrade, auction, rebalancing, other"
        tests:
          - accepted_values:
              arguments:
                values: ["token_transfer", "token_approval", "access_control", "contract_upgrade", "auction", "rebalancing", "other"]

  - name: fct_mint
    description: "Fact table for stablecoin mint events (Transfer events where from_address = 0x0)"
    columns:
      - name: transaction_hash
        description: "Transaction hash (hex string with 0x prefix)"
        tests:
          - not_null
      - name: log_index
        description: "Position of the log within the block"
        tests:
          - not_null
      - name: date_key
        description: "Date dimension key in YYYYMMDD format"
        tests:
          - not_null
      - name: contract_address
        description: "Token contract address"
        tests:
          - not_null
      - name: minting_address
        description: "Address receiving the minted tokens"
        tests:
          - not_null
      - name: minted_amount
        description: "Minted amount adjusted for decimals (assumes 18 decimals)"
      - name: dbt_loaded_at
        description: "Timestamp when record was loaded by dbt"
        tests:
          - not_null

  - name: fct_burn
    description: "Fact table for stablecoin burn events (Transfer events where to_address = 0x0)"
    columns:
      - name: transaction_hash
        description: "Transaction hash (hex string with 0x prefix)"
        tests:
          - not_null
      - name: log_index
        description: "Position of the log within the block"
        tests:
          - not_null
      - name: date_key
        description: "Date dimension key in YYYYMMDD format"
        tests:
          - not_null
      - name: block_number
        description: "Block number where the burn occurred"
        tests:
          - not_null
      - name: block_hash
        description: "Block hash (hex string with 0x prefix)"
      - name: contract_address
        description: "Token contract address"
        tests:
          - not_null
      - name: burned_from_address
        description: "Address where tokens were burned from"
        tests:
          - not_null
      - name: amount_raw
        description: "Raw burned amount as integer (before decimal adjustment)"
      - name: burned_amount
        description: "Burned amount adjusted for decimals (assumes 18 decimals)"
      - name: event_name
        description: "Event name (always 'Transfer')"
      - name: transaction_index
        description: "Position of the transaction within the block"
      - name: dbt_loaded_at
        description: "Timestamp when record was loaded by dbt"
        tests:
          - not_null
